<script
  src="https://code.jquery.com/jquery-3.4.1.min.js"
  integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
  crossorigin="anonymous"
></script>
<script
  src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
  integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
  crossorigin="anonymous"
></script>
<script
  src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
  integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
  crossorigin="anonymous"
></script>

<script>
  function idleLogout() {
    var t;
    window.onload = resetTimer;
    window.onmousemove = resetTimer;
    window.onmousedown = resetTimer; // catches touchscreen presses as well
    window.ontouchstart = resetTimer; // catches touchscreen swipes as well
    window.ontouchmove = resetTimer; // required by some devices
    window.onclick = resetTimer; // catches touchpad clicks as well
    window.onkeydown = resetTimer;
    window.addEventListener('scroll', resetTimer, true);

    function redirectToLogout() {
      window.location.href = '/logout';
    }

    function resetTimer() {
      clearTimeout(t);
      t = setTimeout(redirectToLogout, 120 * 60 * 1000); // 2 hours of inactivity
    }
  }
  idleLogout();
</script>

<script>
  //Alert user of their role
  function checkRole(location) {
    const role = '<%= role %>';
    if (location === 'admin') {
      if (role === 'admin') {
        window.location.href = `/${location}`;
      } else {
        alert(
          "You can't access this page because your role does not allow it. Please contact your admin with any questions on your permissions."
        );
      }
    } else if (location === 'manage') {
      if (role === 'admin' || role === 'director') {
        window.location.href = `/${location}`;
      } else {
        alert(
          "You can't access this page because your role does not allow it. Please contact your admin with any questions on your permissions."
        );
      }
    } else {
      window.location.href = `/${location}`;
    }
  }
</script>

<script>
  //Check if user is not enabled. If they are not, redirect them to the login page and alert them of their status
  //This is outside of a function so that it will run every time the page is refreshed
  const enabled = '<%= enable %>';
  console.log(enabled);
  if (enabled === 'false') {
    window.location.href = '/logout';
    alert(
      'You are not an enabled user. Please contact an admin so that they can enable your account.'
    );
  }
</script>
